<source file="ConcolicEx/ConcolicMalware/src/RefactorUserObject.java" startline="9" endline="27">
public static void main (String [] args) {
    RefactorUserObject refactor = new RefactorUserObject ();
    users = new ArrayList < UserDetails > ();
    refactor.user1 = new UserDetails ();
    refactor.user1.setUserName ("ABC");
    refactor.user1.setUserLevel (3);
    refactor.user1.setUserPermission (true);
    users.add (refactor.user1);
    refactor.user2 = new UserDetails ();
    refactor.user2.setUserName ("XYZ");
    refactor.user2.setUserLevel (4);
    refactor.user2.setUserPermission (false);
    users.add (refactor.user2);
    refactor.refactorUser (refactor.user1.getUserLevel (), 2);
    refactor.refactorUser (refactor.user2.getUserLevel (), 2);
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/RefactorUserObject.java" startline="29" endline="49">
public void refactorUser (int userLevel, int minimumLevel) {
    if (minimumLevel <= userLevel && (userLevel == 3 || userLevel == 4)) {
        for (UserDetails user : users) {
            if (user.getUserLevel () == userLevel) {
                if (user.isUserPermission ()) {
                    System.out.println ("Old user name: " + user.getUserName ());
                    user.setUserName (null);
                    System.out.println ("New user name: " + user.getUserName ());
                } else {
                    user = null;
                    System.gc ();
                    System.out.println ("User deleted");
                }
            }
        }
    }
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserDetails.java" startline="8" endline="10">
public String getUserName () {
    return UserName;
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserDetails.java" startline="11" endline="13">
public void setUserName (String userName) {
    UserName = userName;
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserDetails.java" startline="14" endline="16">
public int getUserLevel () {
    return UserLevel;
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserDetails.java" startline="17" endline="19">
public void setUserLevel (int userLevel) {
    UserLevel = userLevel;
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserDetails.java" startline="20" endline="22">
public boolean isUserPermission () {
    return UserPermission;
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserDetails.java" startline="23" endline="25">
public void setUserPermission (boolean userPermission) {
    UserPermission = userPermission;
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserInformationSystem.java" startline="15" endline="21">
public static void main (String args []) {
    userInformation = new UserInformationSystem ();
    createUser ();
    renameUser (userInformation.user1, "EFG");
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserInformationSystem.java" startline="22" endline="35">
public static void createUser () {
    users = new ArrayList < UserDetails > ();
    userInformation.user1 = new UserDetails ();
    userInformation.user1.setUserName ("ABC");
    userInformation.user1.setUserLevel (3);
    userInformation.user1.setUserPermission (true);
    users.add (userInformation.user1);
    userInformation.user2 = new UserDetails ();
    userInformation.user2.setUserName ("XYZ");
    userInformation.user2.setUserLevel (4);
    userInformation.user2.setUserPermission (false);
    users.add (userInformation.user2);
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserInformationSystem.java" startline="37" endline="43">
public static void renameUser (UserDetails userObject, String newUserName) {
    userObject.setUserName (newUserName);
    userInformation.refactorUser (userInformation.user1.getUserLevel (), 2);
    userInformation.refactorUser (userInformation.user2.getUserLevel (), 2);
}
</source>
<source file="ConcolicEx/ConcolicMalware/src/UserInformationSystem.java" startline="45" endline="65">
public void refactorUser (int userLevel, int minimumLevel) {
    if (minimumLevel <= userLevel) {
        if ((userLevel == 3 || userLevel == 4)) {
            for (UserDetails user : users) {
                if (user.getUserLevel () != userLevel) {
                } else {
                    if (! user.isUserPermission ()) {
                        user = null;
                        System.gc ();
                    } else {
                        user.setUserName (null);
                    }
                }
            }
        }
    }
}
</source>
